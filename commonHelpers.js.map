{"version":3,"file":"commonHelpers.js","sources":["../src/js/fetchPictures.js","../src/js/lightbox.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\n// loader\n\nconst loaderContainer = document.querySelector('.loader')\nfunction showLoader() {\n  loaderContainer.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n  loaderContainer.classList.add('is-hidden');\n}\n\n// fetch\n\nexport default class NewFetchPicture{\n\n\n #URL = 'https://pixabay.com/api/'\n #KEY = '39518708-26ab694120e376c6ae35268e7'\n query = '';\n page = 1;\n per_page = 40;\n image_type='photo';\n safesearch='true';\n orientation='horizontal'\n\n async fetchFunc() {\n  const searchParams = new URLSearchParams({\n    query: this.query,\n    page: this.page,\n    per_page: this.per_page,\n    image_type: this.image_type,\n    safesearch: this.safesearch,\n    orientation: this.orientation,\n  });\n\n  try {\n    showLoader();\n    const response = await axios.get(`${this.#URL}/?key=${this.#KEY}&${searchParams}&q=${this.query}`);\n    this.lastResult = response.data; \n    return this.lastResult;\n\n\n\n\n  } catch (error) {\n    console.error(`Axios error: ${error.message}`);\n    throw error; \n  }\n\n  finally{\n      \n    setTimeout(() => {\n      hideLoader();\n    }, 3000);\n\n  }\n}\n\n\n\nupdatePage(){\nthis.page += 1\n}\n\nresetPage(){\nthis.page = 1\n}\n\nget query() {\n  return this.query;\n}\n\nset query(newRes) {\n  this.query = newRes;\n}\n}\n\n\n\n\n\n\n\n\n","\nexport { lightbox };\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = new SimpleLightbox('.photo-card a', {\n  captions: true,\n  captionDelay: 250,\n});\n\n","\nimport './sass/layouts/_mainform.scss';\nimport NewFetchPicture from './js/fetchPictures.js'\nimport { lightbox } from './js/lightbox.js';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n\n\n\nconst newFetchPicture = new NewFetchPicture()\n\nconst form = document.querySelector('.search-form')\nconst submitBtn = document.querySelector('.submit-btn')\n\nconst markupForm = document.querySelector('.gallery')\nconst loadMoreBtn = document.querySelector('.load-more')\nconst inputEl = document.querySelector('.search-form_input')\nlet currentQuery = '';\n\nform.addEventListener('submit', handleSearchRes)\n\nasync function handleSearchRes(e){\ne.preventDefault();\n\nconsole.log(newFetchPicture)\n\nnewFetchPicture.resetPage()\nnewFetchPicture.query = e.target.elements.searchQuery.value.trim()\ninputEl.value = '';\n\n\nif (newFetchPicture.query === '') {\n  iziToast.warning({\n    message: 'Please, fill the main field', \n    position: 'topLeft', \n\n});\n  return;\n}\n\nif (newFetchPicture.query !== currentQuery) {\n  newFetchPicture.resetPage();\n  currentQuery = newFetchPicture.query;\n  markupForm.innerHTML = '';\n\n  loadMoreBtn.classList.add('is-hidden')\n\n}\n\ntry {\n\n\nconst result = await newFetchPicture.fetchFunc();\ncreateMarkup(result);\n\nlet page = 1;\nlet isLastPage = false;\nconst pageSize = 40;\n\nconst totalResults = result.totalHits;\nconst check = Math.ceil(totalResults / pageSize)\n\nif (page === check) {\n isLastPage = true;\n\n iziToast.info({\n   message: 'You have reached the end of search results',\n   position: 'topRight'\n });\n loadMoreBtn.classList.add('is-hidden');\n} \n page += 1;\n\n console.log(page)\n\n  if (result.totalHits > 1) {\n    iziToast.success({\n      message: `Hooray! We found ${result.totalHits} images.`, \n      position: 'topRight'\n  });\n\n  }\n\n  if (result.totalHits === newFetchPicture.page) {\n    loadMoreBtn.classList.add('is-hidden');\n    return;\n  }\n\n  if (result.totalHits === 0) {\n\n    iziToast.error({\n      message: 'Sorry, there are no images matching your search query. Please try again.', \n      position: 'topRight'\n  });\n    return;\n  }\n\n\n  loadMoreBtn.classList.remove('is-hidden');\n} \n\ncatch (error) {\n  console.error('Error fetching images:', error);\n}\n}\n\n\nloadMoreBtn.addEventListener('click', handleLoadMore)\n\nasync function handleLoadMore() {\n  \n\n  if (newFetchPicture.query === '') {\n    iziToast.warning({\n      message: 'Please, fill the main field', \n      position: 'topRight'\n  });\n\n\n    return;\n  }\n\n  \n\n \n  newFetchPicture.updatePage();\n\n\n  try{\n    const result = await newFetchPicture.fetchFunc()\n\n   \n      createMarkup(result);\n\n      const dynamicDiv = document.querySelector('.photo-card');\n      const height = dynamicDiv.getBoundingClientRect().height;\n        // console.log(height);\n      \n       window.scrollBy({\n        top: 2 * height,\n        behavior: 'smooth',\n      }); \n\n\n      \n     \n    } catch (error) {\n      console.error('Error fetching images:', error);\n    }\n  \n  \n}\n\n\n\n\nfunction createMarkup({ hits }) {\n\n\n  const markup = hits\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `<div class=\"photo-card\">\n          <a href=\"${largeImageURL}\" class=\"photo-link\">\n            <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n          <div class=\"info\">\n            <p class=\"info-item likes\">\n              <b>Likes</b>\n              ${likes}\n            </p>\n            <p class=\"info-item views\">\n              <b>Views</b>\n              ${views}\n            </p>\n            <p class=\"info-item comments\">\n              <b>Comments</b>\n              ${comments}\n            </p>\n            <p class=\"info-item downloads\">\n              <b>Downloads</b>\n              ${downloads}\n            </p>\n          </div>\n        </div>`;\n      }\n    )\n    .join('');\n\n  markupForm.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n\n  //height of the picture\n\n \n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":["loaderContainer","showLoader","hideLoader","NewFetchPicture","__privateAdd","_URL","_KEY","__publicField","searchParams","response","axios","__privateGet","error","newRes","lightbox","SimpleLightbox","newFetchPicture","form","markupForm","loadMoreBtn","inputEl","currentQuery","handleSearchRes","e","iziToast","result","createMarkup","page","isLastPage","pageSize","totalResults","check","handleLoadMore","height","hits","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}