{"version":3,"file":"commonHelpers.js","sources":["../src/js/fetchPictures.js","../src/js/lightbox.js","../src/js/refs.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nclass NewFetchPicture{\n\n #URL = 'https://pixabay.com/api/'\n #KEY = '39518708-26ab694120e376c6ae35268e7'\n query = '';\n page = 1;\n per_page = 40;\n image_type='photo';\n safesearch='true';\n orientation='horizontal'\n\n async fetchImg() {\n  const searchParams = new URLSearchParams({\n    query: this.query,\n    page: this.page,\n    per_page: this.per_page,\n    image_type: this.image_type,\n    safesearch: this.safesearch,\n    orientation: this.orientation,\n  });\n\n\n  \n  const {data} = await axios.get(`${this.#URL}/?key=${this.#KEY}&${searchParams}&q=${this.query}`);\n  return data;\n\n}\n\n\nupdatePage(){\nthis.page += 1\n}\n\nresetPage(){\nthis.page = 1\n}\n\nget query() {\n  return this.query;\n}\n\nset query(newQuery) {\n  this.query = newQuery;\n}\n}\n\nexport const newFetchPicture = new NewFetchPicture()\n\n\n\n\n\n\n\n\n","\nexport { lightbox };\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = new SimpleLightbox('.photo-card a', {\n  captions: true,\n  captionDelay: 250,\n});\n\n","export const refs = {\n\n    form: document.querySelector('.search-form'),\n    loadMoreBtn: document.querySelector('.load-more'), \n    galleryList: document.querySelector('.gallery'),\n    submitBtn: document.querySelector('.submit-btn')\n\n}\n\n\n","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport './sass/layouts/_mainform.scss';\n\nimport { newFetchPicture } from './js/fetchPictures.js'\nimport { lightbox } from './js/lightbox.js';\nimport { refs } from \"./js/refs\";\n\n\nlet currentQuery = '';\n\nrefs.form.addEventListener('submit', handleSearchRes)\n\nasync function handleSearchRes(e){\ne.preventDefault();\n\nrefs.galleryList.innerHTML = '';\nnewFetchPicture.resetPage();\nnewFetchPicture.query = e.target.elements.searchQuery.value.trim();\ne.target.reset();\n\n\nif (newFetchPicture.query === '') {\n  iziToast.warning({\n    message: 'Please, fill the main field', \n    position: 'topLeft', \n\n});\n  return;\n}\n\nif (newFetchPicture.query !== currentQuery) {\n  newFetchPicture.resetPage();\n  currentQuery = newFetchPicture.query;\n  refs.galleryList.innerHTML = '';\n\n  refs.loadMoreBtn.classList.add('is-hidden')\n\n}\n\ntry {\nconst {hits, totalHits} = await newFetchPicture.fetchImg();\n\nif (hits.length === 0) {\n\n  iziToast.error({\n    message: 'Sorry, there are no images matching your search query. Please try again.', \n    position: 'topRight'\n    \n});\n\n  refs.loadMoreBtn.classList.add('is-hidden');\n  return;\n}\n\ncreateMarkup(hits);\nrefs.loadMoreBtn.classList.remove('is-hidden');\n\nif (totalHits > 1) {\n  iziToast.success({\n    message: `Hooray! We found ${totalHits} images.`, \n    position: 'topRight'\n});\n\n}\n\nconst check = Math.ceil(totalHits / newFetchPicture.per_page)\n\nif (newFetchPicture.page === check) {\n\n iziToast.info({\n   message: 'You have reached the end of search results',\n   position: 'topRight'\n });\n refs.loadMoreBtn.classList.add('is-hidden');\n} \n\n\n} \n\ncatch (error) {\n  console.error('Error fetching images:', error);\n}\n}\n\n\nrefs.loadMoreBtn.addEventListener('click', handleLoadMore)\n\nasync function handleLoadMore() {\n newFetchPicture.updatePage();\n\n try{\n    const {hits, totalHits} = await newFetchPicture.fetchImg()\n\n      createMarkup(hits);\n\n      const dynamicDiv = document.querySelector('.photo-card');\n      const height = dynamicDiv.getBoundingClientRect().height;\n        // console.log(height);\n      \n       window.scrollBy({\n       top: 2 * height,\n       behavior: 'smooth',\n      }); \n\n    const check = Math.ceil(totalHits / newFetchPicture.per_page)\n\n    if (newFetchPicture.page === check) {\n\n       iziToast.info({\n       message: 'You have reached the end of search results',\n       position: 'topRight'\n });\n refs.loadMoreBtn.classList.add('is-hidden');\n} \n\n    } catch (error) {\n      console.error('Error fetching images:', error);\n    }\n  \n}\n\n\n\n\nfunction createMarkup( hits ) {\n\n\n  const markup = hits\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `<div class=\"photo-card\">\n          <a href=\"${largeImageURL}\" class=\"photo-link\">\n            <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n          <div class=\"info\">\n            <p class=\"info-item likes\">\n              <b>Likes</b>\n              ${likes}\n            </p>\n            <p class=\"info-item views\">\n              <b>Views</b>\n              ${views}\n            </p>\n            <p class=\"info-item comments\">\n              <b>Comments</b>\n              ${comments}\n            </p>\n            <p class=\"info-item downloads\">\n              <b>Downloads</b>\n              ${downloads}\n            </p>\n          </div>\n        </div>`;\n      }\n    )\n    .join('');\n\n  refs.galleryList.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n\n  //height of the picture\n\n \n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":["NewFetchPicture","__privateAdd","_URL","_KEY","__publicField","searchParams","data","axios","__privateGet","newQuery","newFetchPicture","lightbox","SimpleLightbox","refs","currentQuery","handleSearchRes","e","iziToast","hits","totalHits","createMarkup","check","error","handleLoadMore","height","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}